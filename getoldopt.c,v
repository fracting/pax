head	1.1;
branch	1.1.221;
access;
symbols
	pax-20120606-2+deb7u1:1.1.221.4
	wheezy:1.1.221.4.0.2
	pax-20120606-3:1.1.221.4
	pax-20120606-2:1.1.221.4
	pax-20120606-1:1.1.221.4
	pax-20120606:1.1.221.4
	pax-20120605-1:1.1.221.4
	pax-20120605:1.1.221.4
	pax-20120520-1:1.1.221.4
	pax-20120520:1.1.221.4
	pax-20120216-2:1.1.221.3
	pax-20120216-1:1.1.221.3
	pax-20120216:1.1.221.3
	pax-20120212-1:1.1.221.3
	pax-20120212:1.1.221.3
	pax-20120211-1:1.1.221.3
	pax-20120211:1.1.221.3
	mircpio_20110817:1.1.221.2
	mircpio-20091122:1.1.221.1
	mircpio-20080906:1.1.221.1
	origtgz:1.1.221;
locks; strict;
comment	@ * @;
expand	@b@;


1.1
date	2011.07.28.16.48.00;	author tg;	state Exp;
branches
	1.1.221.1;
next	;
commitid	1004E3192C8046E063B;

1.1.221.1
date	2011.07.28.16.48.00;	author tg;	state Exp;
branches;
next	1.1.221.2;
commitid	1004E3192C8046E063B;

1.1.221.2
date	2011.08.17.09.18.28;	author tg;	state Exp;
branches;
next	1.1.221.3;
commitid	1004E4B875015FAFEA7;

1.1.221.3
date	2012.02.12.02.23.17;	author tg;	state Exp;
branches;
next	1.1.221.4;
commitid	1004F372297099197B4;

1.1.221.4
date	2012.05.20.17.38.56;	author tg;	state Exp;
branches;
next	;
commitid	1004FB92C473E896F98;


desc
@@


1.1
log
@Initial revision
@
text
@/*	$OpenBSD: getoldopt.c,v 1.8 2003/07/02 21:19:33 deraadt Exp $	*/
/*	$NetBSD: getoldopt.c,v 1.3 1995/03/21 09:07:28 cgd Exp $	*/

/*
 * Plug-compatible replacement for getopt() for parsing tar-like
 * arguments.  If the first argument begins with "-", it uses getopt;
 * otherwise, it uses the old rules used by tar, dump, and ps.
 *
 * Written 25 August 1985 by John Gilmore (ihnp4!hoptoad!gnu) and placed
 * in the Public Domain for your edification and enjoyment.
 */

#include <sys/types.h>
#include <sys/stat.h>
#include <stdio.h>
#include <string.h>
#include <unistd.h>
#include "pax.h"
#include "extern.h"

__RCSID("$MirOS: src/bin/pax/getoldopt.c,v 1.2 2007/02/17 04:52:40 tg Exp $");

int
getoldopt(int argc, char **argv, const char *optstring)
{
	static char	*key;		/* Points to next keyletter */
	static char	use_getopt;	/* !=0 if argv[1][0] was '-' */
	char		c;
	char		*place;

	optarg = NULL;

	if (key == NULL) {		/* First time */
		if (argc < 2)
			return (-1);
		key = argv[1];
		if (*key == '-')
			use_getopt++;
		else
			optind = 2;
	}

	if (use_getopt)
		return (getopt(argc, argv, optstring));

	c = *key++;
	if (c == '\0') {
		key--;
		return (-1);
	}
	place = strchr(optstring, c);

	if (place == NULL || c == ':') {
		fprintf(stderr, "%s: unknown option %c\n", argv[0], c);
		return ('?');
	}

	place++;
	if (*place == ':') {
		if (optind < argc) {
			optarg = argv[optind];
			optind++;
		} else {
			fprintf(stderr, "%s: %c argument missing\n",
				argv[0], c);
			return ('?');
		}
	}

	return (c);
}
@


1.1.221.1
log
@Import mircpio_20080906.orig.tar.gz
(even though this package needs a general rework, and -M dirslash too)
@
text
@@


1.1.221.2
log
@Import distfile into vendor branch
-r--r--r--  1 tg  miros-cvssrc  136185 Aug 17 09:14 /MirOS/dist/mir/cpio/paxmirabilis-20110817.cpio.gz
-rw-r--r--  1 tg  tg            138201 Aug 17 09:14 paxmirabilis_20110817.orig.tar.gz
@
text
@d13 1
a13 1
#include <sys/param.h>
d21 1
a21 1
__RCSID("$MirOS: src/bin/pax/getoldopt.c,v 1.3 2011/08/16 13:57:14 tg Exp $");
@


1.1.221.3
log
@-rw-r--r--   1 tg  tg  138869 Feb 12 02:14 pax_20120211.orig.tar.gz
-rw-r--r--   1 tg  tg  136890 Feb 12 02:14 paxmirabilis-20120211.cpio.gz
@
text
@d1 1
a1 1
/*	$OpenBSD: getoldopt.c,v 1.9 2009/10/27 23:59:22 deraadt Exp $	*/
d21 1
a21 1
__RCSID("$MirOS: src/bin/pax/getoldopt.c,v 1.4 2012/02/12 00:27:16 tg Exp $");
@


1.1.221.4
log
@pax_20120520.orig.tar.gz
@
text
@a16 1
#include <time.h>
d21 1
a21 1
__RCSID("$MirOS: src/bin/pax/getoldopt.c,v 1.5 2012/05/20 16:13:18 tg Exp $");
@


